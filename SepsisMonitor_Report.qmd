---
title: "Sepsis Monitor"
author: "Katherine Giorgio"
format: html
---

```{r setup}
library(tidyverse)
library(data.table) ## For the fread function
library(lubridate)
library(googledrive)
library(gt)

source("sepsis_monitor_functions.R")

# authenticating Google Drive connection
drive_auth(email = "giorg024@umn.edu",
           path = "C:\\Users\\kathe\\OneDrive\\Desktop\\04 Advanced R\\Code - Git\\7462-sepsis-monitor\\googledrive_apikey.txt")

# initialize patients
df <- initializePatients()

# We have to write the file to disk first, then upload it
df %>% write_csv("sepsis_report_temp.csv")

# Uploading happens here
drive_put(media = "sepsis_report_temp.csv",  
          path = "https://drive.google.com/drive/folders/1bw6XgCMdGh1DyMIGOm1mPTTDP5rtny5W?usp=share_link",
          name = "sepsis_report.csv")
```



```{r content}
CurrentSepsisTable <- df %>% 
  #filter(SepsisLabel == 1) %>% 
  select(c(PatientID, HR, Temp, Resp)) %>% 
  gt() %>% 
  tab_header(title = "Sepsis Patients' Current Status",
             subtitle = "data updated every hour") %>% 
  cols_label(PatientID = "Patient ID",
             HR = "Heart Rate",
             Temp = "Body Temperature",
             Resp = "Respirations") %>% 
  cols_align(align="center")

```


